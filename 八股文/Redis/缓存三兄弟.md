缓存穿透、缓存击穿和缓存雪崩

#### 缓存穿透
数据库没有对应的结果，所以缓存里面也没有
因为缓存没有，所以查询的时候要去查数据库
数据库压力太大，容易直接宕机

一般发生在黑客攻击的时候

解决方案：
- 缓存null值
优点：实现简单
缺点：占用内存，可能会导致缓存不一致

- 布隆过滤器
是一个能快速检验是否数据库有对应数据的数据结构
优点：内存占用小
缺点：存在误判的可能性

- 限流
通过nginx拦截同IP的过多请求

#### 缓存击穿
在hot key过期的瞬间，很多查询访问数据库导致宕机

解决方案：
- 互斥锁
查询需要获取锁才可以访问数据
这样能保证过期的时候只有少量查询直接访问数据库
![](https://i-blog.csdnimg.cn/direct/24e6ac5f9b224449aa9d251337ae8136.png)

优点：保证数据的一致性
缺点：性能损耗
同时，互斥锁还涉及到上下文切换，大幅增加了性能的损耗

- 逻辑过期
类似于逻辑删除，存入热key时，新增字段`{"id": 1, "title": "Redis缓存面试三兄弟", "expire": 1721394558}`
当热点数据过期时，先返回旧数据，再由后台异步更新缓存

优点：提高并发量
缺点：减少了缓存一致性

#### 缓存雪崩
和缓存击穿类似，区别是一瞬间大量key过期

解决方案：
- 随机过期
设定key的过期时间时设定一个随机偏移时间

- 搭建集群
三大[[集群]]模式

- 多级缓存
可以用Caffine作为一级缓存，Redis作为二级缓存

